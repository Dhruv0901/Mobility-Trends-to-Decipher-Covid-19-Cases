import pandas as pd
main = pd.read_csv('final_covid_count.csv')
main['date'] = pd.to_datetime(main['date'])
main['month'] = main['date'].dt.month
main['year'] = main['date'].dt.year
main['covid_cases'] = 0
covid_cases_map = {
    # 2020
    (2020, 1, 'Australian Capital Territory'): 1,
    (2020, 1, 'New South Wales'): 4,
    (2020, 1, 'Northern Territory'): 0,
    (2020, 1, 'Queensland'): 3,
    (2020, 1, 'South Australia'): 5,
    (2020, 1, 'Tasmania'): 0,
    (2020, 1, 'Victoria'): 5,
    (2020, 1, 'Western Australia'): 0,

    (2020, 2, 'Australian Capital Territory'): 6,
    (2020, 2, 'New South Wales'): 52,
    (2020, 2, 'Northern Territory'): 0,
    (2020, 2, 'Queensland'): 19,
    (2020, 2, 'South Australia'): 4,
    (2020, 2, 'Tasmania'): 2,
    (2020, 2, 'Victoria'): 35,
    (2020, 2, 'Western Australia'): 4,

    (2020, 3, 'Australian Capital Territory'): 110,
    (2020, 3, 'New South Wales'): 2774,
    (2020, 3, 'Northern Territory'): 25,
    (2020, 3, 'Queensland'): 990,
    (2020, 3, 'South Australia'): 429,
    (2020, 3, 'Tasmania'): 85,
    (2020, 3, 'Victoria'): 1243,
    (2020, 3, 'Western Australia'): 502,

    (2020, 4, 'Australian Capital Territory'): 12,
    (2020, 4, 'New South Wales'): 440,
    (2020, 4, 'Northern Territory'): 4,
    (2020, 4, 'Queensland'): 72,
    (2020, 4, 'South Australia'): 26,
    (2020, 4, 'Tasmania'): 145,
    (2020, 4, 'Victoria'): 240,
    (2020, 4, 'Western Australia'): 99,

    (2020, 5, 'Australian Capital Territory'): 4,
    (2020, 5, 'New South Wales'): 66,
    (2020, 5, 'Northern Territory'): 0,
    (2020, 5, 'Queensland'): 10,
    (2020, 5, 'South Australia'): 2,
    (2020, 5, 'Tasmania'): 2,
    (2020, 5, 'Victoria'): 314,
    (2020, 5, 'Western Australia'): 37,

    (2020, 6, 'Australian Capital Territory'): 6,
    (2020, 6, 'New South Wales'): 133,
    (2020, 6, 'Northern Territory'): 1,
    (2020, 6, 'Queensland'): 10,
    (2020, 6, 'South Australia'): 5,
    (2020, 6, 'Tasmania'): 2,
    (2020, 6, 'Victoria'): 969,
    (2020, 6, 'Western Australia'): 18,

    (2020, 7, 'Australian Capital Territory'): 11,
    (2020, 7, 'New South Wales'): 392,
    (2020, 7, 'Northern Territory'): 1,
    (2020, 7, 'Queensland'): 19,
    (2020, 7, 'South Australia'): 11,
    (2020, 7, 'Tasmania'): 5,
    (2020, 7, 'Victoria'): 9785,
    (2020, 7, 'Western Australia'): 46,

    (2020, 8, 'Australian Capital Territory'): 2,
    (2020, 8, 'New South Wales'): 277,
    (2020, 8, 'Northern Territory'): 0,
    (2020, 8, 'Queensland'): 47,
    (2020, 8, 'South Australia'): 9,
    (2020, 8, 'Tasmania'): 2,
    (2020, 8, 'Victoria'): 6939,
    (2020, 8, 'Western Australia'): 14,

    (2020, 9, 'Australian Capital Territory'): 0,
    (2020, 9, 'New South Wales'): 165,
    (2020, 9, 'Northern Territory'): 0,
    (2020, 9, 'Queensland'): 27,
    (2020, 9, 'South Australia'): 12,
    (2020, 9, 'Tasmania'): 0,
    (2020, 9, 'Victoria'): 914,
    (2020, 9, 'Western Australia'): 33,

    (2020, 10, 'Australian Capital Territory'): 3,
    (2020, 10, 'New South Wales'): 205,
    (2020, 10, 'Northern Territory'): 6,
    (2020, 10, 'Queensland'): 15,
    (2020, 10, 'South Australia'): 33,
    (2020, 10, 'Tasmania'): 0,
    (2020, 10, 'Victoria'): 170,
    (2020, 10, 'Western Australia'): 88,

    (2020, 11, 'Australian Capital Territory'): 6,
    (2020, 11, 'New South Wales'): 168,
    (2020, 11, 'Northern Territory'): 23,
    (2020, 11, 'Queensland'): 32,
    (2020, 11, 'South Australia'): 57,
    (2020, 11, 'Tasmania'): 0,
    (2020, 11, 'Victoria'): 25,
    (2020, 11, 'Western Australia'): 58,

    (2020, 12, 'Australian Capital Territory'): 1,
    (2020, 12, 'New South Wales'): 369,
    (2020, 12, 'Northern Territory'): 20,
    (2020, 12, 'Queensland'): 51,
    (2020, 12, 'South Australia'): 20,
    (2020, 12, 'Tasmania'): 4,
    (2020, 12, 'Victoria'): 90,
    (2020, 12, 'Western Australia'): 48,

    # 2021
    (2021, 1, 'Australian Capital Territory'): 28,
    (2021, 1, 'New South Wales'): 235,
    (2021, 1, 'Northern Territory'): 30,
    (2021, 1, 'Queensland'): 72,
    (2021, 1, 'South Australia'): 37,
    (2021, 1, 'Tasmania'): 2,
    (2021, 1, 'Victoria'): 134,
    (2021, 1, 'Western Australia'): 35,

    (2021, 2, 'Australian Capital Territory'): 7,
    (2021, 2, 'New South Wales'): 63,
    (2021, 2, 'Northern Territory'): 7,
    (2021, 2, 'Queensland'): 33,
    (2021, 2, 'South Australia'): 22,
    (2021, 2, 'Tasmania'): 1,
    (2021, 2, 'Victoria'): 101,
    (2021, 2, 'Western Australia'): 15,

    (2021, 3, 'Australian Capital Territory'): 28,
    (2021, 3, 'New South Wales'): 88,
    (2021, 3, 'Northern Territory'): 5,
    (2021, 3, 'Queensland'): 159,
    (2021, 3, 'South Australia'): 46,
    (2021, 3, 'Tasmania'): 1,
    (2021, 3, 'Victoria'): 96,
    (2021, 3, 'Western Australia'): 50,

    (2021, 4, 'Australian Capital Territory'): 21,
    (2021, 4, 'New South Wales'): 154,
    (2021, 4, 'Northern Territory'): 56,
    (2021, 4, 'Queensland'): 73,
    (2021, 4, 'South Australia'): 65,
    (2021, 4, 'Tasmania'): 0,
    (2021, 4, 'Victoria'): 126,
    (2021, 4, 'Western Australia'): 78,

    (2021, 5, 'Australian Capital Territory'): 2,
    (2021, 5, 'New South Wales'): 68,
    (2021, 5, 'Northern Territory'): 9,
    (2021, 5, 'Queensland'): 64,
    (2021, 5, 'South Australia'): 25,
    (2021, 5, 'Tasmania'): 0,
    (2021, 5, 'Victoria'): 187,
    (2021, 5, 'Western Australia'): 30,

    (2021, 6, 'Australian Capital Territory'): 2,
    (2021, 6, 'New South Wales'): 339,
    (2021, 6, 'Northern Territory'): 12,
    (2021, 6, 'Queensland'): 86,
    (2021, 6, 'South Australia'): 39,
    (2021, 6, 'Tasmania'): 0,
    (2021, 6, 'Victoria'): 141,
    (2021, 6, 'Western Australia'): 22,

    (2021, 7, 'Australian Capital Territory'): 6,
    (2021, 7, 'New South Wales'): 3769,
    (2021, 7, 'Northern Territory'): 14,
    (2021, 7, 'Queensland'): 125,
    (2021, 7, 'South Australia'): 50,
    (2021, 7, 'Tasmania'): 0,
    (2021, 7, 'Victoria'): 306,
    (2021, 7, 'Western Australia'): 35,

    (2021, 8, 'Australian Capital Territory'): 336,
    (2021, 8, 'New South Wales'): 21229,
    (2021, 8, 'Northern Territory'): 4,
    (2021, 8, 'Queensland'): 160,
    (2021, 8, 'South Australia'): 11,
    (2021, 8, 'Tasmania'): 1,
    (2021, 8, 'Victoria'): 1743,
    (2021, 8, 'Western Australia'): 30,

    (2021, 9, 'Australian Capital Territory'): 660,
    (2021, 9, 'New South Wales'): 33790,
    (2021, 9, 'Northern Territory'): 11,
    (2021, 9, 'Queensland'): 59,
    (2021, 9, 'South Australia'): 24,
    (2021, 9, 'Tasmania'): 0,
    (2021, 9, 'Victoria'): 19816,
    (2021, 9, 'Western Australia'): 26,

    (2021, 10, 'Australian Capital Territory'): 684,
    (2021, 10, 'New South Wales'): 10786,
    (2021, 10, 'Northern Territory'): 14,
    (2021, 10, 'Queensland'): 55,
    (2021, 10, 'South Australia'): 19,
    (2021, 10, 'Tasmania'): 2,
    (2021, 10, 'Victoria'): 49425,
    (2021, 10, 'Western Australia'): 11,

    (2021, 11, 'Australian Capital Territory'): 357,
    (2021, 11, 'New South Wales'): 6670,
    (2021, 11, 'Northern Territory'): 70,
    (2021, 11, 'Queensland'): 50,
    (2021, 11, 'South Australia'): 48,
    (2021, 11, 'Tasmania'): 3,
    (2021, 11, 'Victoria'): 33515,
    (2021, 11, 'Western Australia'): 17,

    (2021, 12, 'Australian Capital Territory'): 4259,
    (2021, 12, 'New South Wales'): 203048,
    (2021, 12, 'Northern Territory'): 479,
    (2021, 12, 'Queensland'): 30681,
    (2021, 12, 'South Australia'): 18172,
    (2021, 12, 'Tasmania'): 1620,
    (2021, 12, 'Victoria'): 93809,
    (2021, 12, 'Western Australia'): 75,

    # 2022
    (2022, 1, 'Australian Capital Territory'): 30267,
    (2022, 1, 'New South Wales'): 637162,
    (2022, 1, 'Northern Territory'): 15573,
    (2022, 1, 'Queensland'): 372407,
    (2022, 1, 'South Australia'): 90324,
    (2022, 1, 'Tasmania'): 27849,
    (2022, 1, 'Victoria'): 635278,
    (2022, 1, 'Western Australia'): 850,

    (2022, 2, 'Australian Capital Territory'): 14585,
    (2022, 2, 'New South Wales'): 230212,
    (2022, 2, 'Northern Territory'): 23475,
    (2022, 2, 'Queensland'): 140743,
    (2022, 2, 'South Australia'): 44485,
    (2022, 2, 'Tasmania'): 17719,
    (2022, 2, 'Victoria'): 204531,
    (2022, 2, 'Western Australia'): 11890,

    (2022, 3, 'Australian Capital Territory'): 27518,
    (2022, 3, 'New South Wales'): 536603,
    (2022, 3, 'Northern Territory'): 10117,
    (2022, 3, 'Queensland'): 196224,
    (2022, 3, 'South Australia'): 120671,
    (2022, 3, 'Tasmania'): 46429,
    (2022, 3, 'Victoria'): 250087,
    (2022, 3, 'Western Australia'): 180637,

    (2022, 4, 'Australian Capital Territory'): 27290,
    (2022, 4, 'New South Wales'): 432385,
    (2022, 4, 'Northern Territory'): 13471,
    (2022, 4, 'Queensland'): 201081,
    (2022, 4, 'South Australia'): 140274,
    (2022, 4, 'Tasmania'): 44022,
    (2022, 4, 'Victoria'): 274955,
    (2022, 4, 'Western Australia'): 208389,

    (2022, 5, 'Australian Capital Territory'): 27693,
    (2022, 5, 'New South Wales'): 297264,
    (2022, 5, 'Northern Territory'): 8656,
    (2022, 5, 'Queensland'): 152929,
    (2022, 5, 'South Australia'): 108230,
    (2022, 5, 'Tasmania'): 28273,
    (2022, 5, 'Victoria'): 333310,
    (2022, 5, 'Western Australia'): 355970,

    (2022, 6, 'Australian Capital Territory'): 26904,
    (2022, 6, 'New South Wales'): 233899,
    (2022, 6, 'Northern Territory'): 6717,
    (2022, 6, 'Queensland'): 117015,
    (2022, 6, 'South Australia'): 77412,
    (2022, 6, 'Tasmania'): 24716,
    (2022, 6, 'Victoria'): 215082,
    (2022, 6, 'Western Australia'): 183825,

    (2022, 7, 'Australian Capital Territory'): 31639,
    (2022, 7, 'New South Wales'): 378603,
    (2022, 7, 'Northern Territory'): 12579,
    (2022, 7, 'Queensland'): 197463,
    (2022, 7, 'South Australia'): 117403,
    (2022, 7, 'Tasmania'): 42272,
    (2022, 7, 'Victoria'): 312112,
    (2022, 7, 'Western Australia'): 159884,

    (2022, 8, 'Australian Capital Territory'): 10537,
    (2022, 8, 'New South Wales'): 230048,
    (2022, 8, 'Northern Territory'): 4987,
    (2022, 8, 'Queensland'): 71359,
    (2022, 8, 'South Australia'): 40511,
    (2022, 8, 'Tasmania'): 12904,
    (2022, 8, 'Victoria'): 125427,
    (2022, 8, 'Western Australia'): 59856,

    (2022, 9, 'Australian Capital Territory'): 3265,
    (2022, 9, 'New South Wales'): 68853,
    (2022, 9, 'Northern Territory'): 1762,
    (2022, 9, 'Queensland'): 30273,
    (2022, 9, 'South Australia'): 15285,
    (2022, 9, 'Tasmania'): 3876,
    (2022, 9, 'Victoria'): 46666,
    (2022, 9, 'Western Australia'): 24594,

    (2022, 10, 'Australian Capital Territory'): 2986,
    (2022, 10, 'New South Wales'): 44499,
    (2022, 10, 'Northern Territory'): 1183,
    (2022, 10, 'Queensland'): 16737,
    (2022, 10, 'South Australia'): 13175,
    (2022, 10, 'Tasmania'): 3654,
    (2022, 10, 'Victoria'): 36393,
    (2022, 10, 'Western Australia'): 23869,

    (2022, 11, 'Australian Capital Territory'): 7073,
    (2022, 11, 'New South Wales'): 122096,
    (2022, 11, 'Northern Territory'): 1804,
    (2022, 11, 'Queensland'): 36446,
    (2022, 11, 'South Australia'): 37164,
    (2022, 11, 'Tasmania'): 11681,
    (2022, 11, 'Victoria'): 92897,
    (2022, 11, 'Western Australia'): 42834,

    (2022, 12, 'Australian Capital Territory'): 11318,
    (2022, 12, 'New South Wales'): 156458,
    (2022, 12, 'Northern Territory'): 2852,
    (2022, 12, 'Queensland'): 54280,
    (2022, 12, 'South Australia'): 44508,
    (2022, 12, 'Tasmania'): 16273,
    (2022, 12, 'Victoria'): 94601,
    (2022, 12, 'Western Australia'): 45414,
}

for index, row in main.iterrows():
    # Get the date, year, month, and state
    date = row['date']
    year = row['year']
    month = row['month']
    state = row['sub_region_1']

    # Check if the date is the last day of the month
    if date == (date + pd.offsets.MonthEnd(0)):
        # Update the covid_cases based on the mapping if it exists
        if (year, month, state) in covid_cases_map:
            main.at[index, 'covid_cases'] = covid_cases_map[(year, month, state)]
    else:
        # Set covid_cases to zero for all other days
        main.at[index, 'covid_cases'] = 0

# Save the updated DataFrame to a new CSV file
main.to_csv('AU_Mobility_Report_with_COVID_Cases.csv', index=False)
